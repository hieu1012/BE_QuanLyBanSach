# Sơ đồ Use Case - Ứng dụng Quản Lý Bán Sách

## Mô tả tổng quát

Ứng dụng quản lý bán sách online là một hệ thống e-commerce cho phép người dùng mua sách, quản lý đơn hàng, và admin quản lý sản phẩm.

---

## Sơ đồ Use Case (Biểu diễn bằng PlantUML)

```
@startuml
left to right direction
skinparam packageStyle rectangle

actor "Khách Hàng" as Customer
actor "Admin" as Admin
actor "Master Admin" as Master

rectangle "Hệ thống Quản Lý Bán Sách" {
  ' === Authentication & User Management ===
  usecase "Đăng Ký" as UC_Register
  usecase "Đăng Nhập" as UC_Login
  usecase "Quên Mật Khẩu" as UC_ForgotPassword
  usecase "Đặt Lại Mật Khẩu" as UC_ResetPassword
  usecase "Xem Hồ Sơ" as UC_ViewProfile
  usecase "Cập Nhật Hồ Sơ" as UC_UpdateProfile

  ' === Product Management ===
  usecase "Xem Danh Sách Sách" as UC_ViewProducts
  usecase "Xem Chi Tiết Sách" as UC_ViewProductDetail
  usecase "Tìm Kiếm Sách" as UC_SearchProduct
  usecase "Lọc Theo Danh Mục" as UC_FilterByCategory
  usecase "Thêm Sách" as UC_AddProduct
  usecase "Cập Nhật Sách" as UC_UpdateProduct
  usecase "Xóa Sách" as UC_DeleteProduct
  usecase "Quản Lý Hình Ảnh Sách" as UC_ManageImages

  ' === Category Management ===
  usecase "Xem Danh Mục" as UC_ViewCategories
  usecase "Thêm Danh Mục" as UC_AddCategory
  usecase "Cập Nhật Danh Mục" as UC_UpdateCategory
  usecase "Xóa Danh Mục" as UC_DeleteCategory

  ' === Shopping Cart ===
  usecase "Xem Giỏ Hàng" as UC_ViewCart
  usecase "Thêm Vào Giỏ" as UC_AddToCart
  usecase "Cập Nhật Số Lượng" as UC_UpdateQuantity
  usecase "Xóa Khỏi Giỏ" as UC_RemoveFromCart
  usecase "Xóa Toàn Bộ Giỏ" as UC_ClearCart

  ' === Order Management ===
  usecase "Tạo Đơn Hàng" as UC_CreateOrder
  usecase "Xem Đơn Hàng" as UC_ViewOrder
  usecase "Lịch Sử Đơn Hàng" as UC_OrderHistory
  usecase "Hủy Đơn Hàng" as UC_CancelOrder
  usecase "Quản Lý Đơn Hàng" as UC_ManageOrder
  usecase "Cập Nhật Trạng Thái Đơn" as UC_UpdateOrderStatus

  ' === Statistics & Reporting ===
  usecase "Xem Thống Kê" as UC_ViewStatistics
  usecase "Báo Cáo Doanh Thu" as UC_RevenueReport
  usecase "Báo Cáo Sản Phẩm" as UC_ProductReport
  usecase "Báo Cáo Người Dùng" as UC_UserReport

  ' === User Management (Admin) ===
  usecase "Quản Lý Người Dùng" as UC_ManageUsers
  usecase "Khóa/Mở Người Dùng" as UC_LockUnlockUser
  usecase "Gán Quyền" as UC_AssignRole

  ' === Relationships for Customer ===
  Customer --> UC_Register
  Customer --> UC_Login
  Customer --> UC_ForgotPassword
  Customer --> UC_ViewProfile
  Customer --> UC_UpdateProfile
  Customer --> UC_ViewProducts
  Customer --> UC_ViewProductDetail
  Customer --> UC_SearchProduct
  Customer --> UC_FilterByCategory
  Customer --> UC_ViewCart
  Customer --> UC_AddToCart
  Customer --> UC_UpdateQuantity
  Customer --> UC_RemoveFromCart
  Customer --> UC_ClearCart
  Customer --> UC_CreateOrder
  Customer --> UC_ViewOrder
  Customer --> UC_OrderHistory
  Customer --> UC_CancelOrder

  ' === Relationships for Admin ===
  Admin --> UC_Login
  Admin --> UC_ViewProfile
  Admin --> UC_UpdateProfile
  Admin --> UC_ViewProducts
  Admin --> UC_AddProduct
  Admin --> UC_UpdateProduct
  Admin --> UC_DeleteProduct
  Admin --> UC_ManageImages
  Admin --> UC_ViewCategories
  Admin --> UC_AddCategory
  Admin --> UC_UpdateCategory
  Admin --> UC_DeleteCategory
  Admin --> UC_ManageOrder
  Admin --> UC_UpdateOrderStatus
  Admin --> UC_ViewStatistics
  Admin --> UC_RevenueReport
  Admin --> UC_ProductReport
  Admin --> UC_ManageUsers

  ' === Relationships for Master ===
  Master --> UC_Login
  Master --> UC_ManageUsers
  Master --> UC_LockUnlockUser
  Master --> UC_AssignRole
  Master --> UC_ViewStatistics
  Master --> UC_ManageOrder
  Master --> UC_UpdateOrderStatus
  Master --> UC_RevenueReport
  Master --> UC_ProductReport
  Master --> UC_UserReport

  ' === Include relationships ===
  UC_ResetPassword ..|> UC_ForgotPassword
  UC_AddToCart ..|> UC_ViewProducts
  UC_CreateOrder ..|> UC_ViewCart
  UC_ViewCart ..|> UC_ViewProducts
  UC_UpdateOrderStatus ..|> UC_ManageOrder
  UC_ViewStatistics ..|> UC_RevenueReport
  UC_ViewStatistics ..|> UC_ProductReport

}

@enduml
```

---

## Tóm tắt các chức năng chính

### 1. **Quản lý Xác Thực (Authentication)**

-   Đăng ký người dùng mới
-   Đăng nhập bằng username/password
-   Quên mật khẩu và đặt lại mật khẩu
-   Quản lý JWT Token

### 2. **Quản lý Sản Phẩm (Product Management)**

-   Xem danh sách sách (có phân trang)
-   Xem chi tiết sách
-   Tìm kiếm và lọc theo danh mục
-   **Admin**: Thêm, cập nhật, xóa sách
-   **Admin**: Quản lý hình ảnh (upload to Cloudinary)

### 3. **Quản lý Danh Mục (Category Management)**

-   Xem danh sách danh mục
-   **Admin**: Thêm, cập nhật, xóa danh mục

### 4. **Giỏ Hàng (Shopping Cart)**

-   Xem giỏ hàng hiện tại
-   Thêm sách vào giỏ
-   Cập nhật số lượng
-   Xóa sách khỏi giỏ
-   Xóa toàn bộ giỏ

### 5. **Quản lý Đơn Hàng (Order Management)**

-   Tạo đơn hàng từ giỏ hàng
-   Xem chi tiết đơn hàng
-   Xem lịch sử đơn hàng
-   Hủy đơn hàng
-   **Admin**: Quản lý, cập nhật trạng thái đơn hàng

### 6. **Thống Kê & Báo Cáo (Statistics & Reporting)**

-   **Admin/Master**: Xem thống kê tổng quan
-   **Admin/Master**: Báo cáo doanh thu
-   **Admin/Master**: Báo cáo sản phẩm
-   **Master**: Báo cáo người dùng

### 7. **Quản lý Người Dùng (User Management)**

-   **Master**: Quản lý danh sách người dùng
-   **Master**: Khóa/Mở tài khoản người dùng
-   **Master**: Gán quyền (Role) cho người dùng

---

## Phân Quyền Hệ Thống

| Chức Năng          | Khách Hàng   | Admin | Master |
| ------------------ | ------------ | ----- | ------ |
| Xem Sách           | ✅           | ✅    | ✅     |
| Thêm/Sửa/Xóa Sách  | ❌           | ✅    | ✅     |
| Mua Hàng           | ✅           | ✅    | ✅     |
| Quản Lý Đơn Hàng   | Chỉ Của Mình | ✅    | ✅     |
| Xem Thống Kê       | ❌           | ✅    | ✅     |
| Quản Lý Người Dùng | ❌           | ❌    | ✅     |
| Quản Lý Danh Mục   | ❌           | ✅    | ✅     |

---

## Controllers Trong Ứng Dụng

1. **AuthController** - Xử lý đăng nhập, đăng ký, quên mật khẩu
2. **UserController** - Quản lý hồ sơ người dùng
3. **ProductController** - Quản lý sản phẩm (sách)
4. **CategoryController** - Quản lý danh mục sách
5. **CartController** - Quản lý giỏ hàng
6. **OrderController** - Quản lý đơn hàng của khách hàng
7. **AdminOrderController** - Quản lý đơn hàng của admin
8. **AdminController** - Quản lý người dùng, toàn quyền admin
9. **StatisticsController** - Xem thống kê và báo cáo

---

## Ghi Chú

-   Hệ thống sử dụng **Spring Security** để xác thực và phân quyền
-   Hình ảnh được lưu trữ trên **Cloudinary** (Cloud storage)
-   Dữ liệu được lưu trong **Database** (SQL)
-   Sử dụng **JWT Token** để quản lý phiên đăng nhập
-   Có 3 cấp quyền: **USER**, **ADMIN**, **MASTER**
